<html>
<style>
html{
    background: #0b0b0b;
}
.pahom{
    width: 258px;
    height: 256px;
    display: block;
    transition: .2s;

}
@font-face {
    font-family: PixelizerBold;
    src: url("assets/PixelizerBold.ttf");
}
.game_container{
    width: 100%;
    height: 100%;
    background-image: url("assets/back.jpg");
    border: 1px solid #636363;
    background-size: 200% 200%;
}
.bread{
    width: 96px;
    height: 96px;
    display: block;
}
.framerate{
    color: white;
    font-size: 30px;
    font-family: 'PixelizerBold';
    display: inline-block;
    margin: 20px;
}
.text{
    color: white;
    font-size: 15px;
    font-family: 'PixelizerBold';
    margin: 20px;
}
.stext{
    color: white;
    font-size: 15px;
    font-family: 'PixelizerBold';
    margin: 5px;display: inline-block;
    transform: translateX(20px);
}
img{
    width: 100%;
    height: 100%;
}
.score{
    color: white;
    font-size: 60px;
    font-weight: bold;
    text-align: center;
    font-family: 'PixelizerBold';
}
.menuBtn{
    width: 90%;
    height: 30px;
    border: 1px solid #636363;
    background: #c7bfbf;
    color: rgb(0, 0, 0);
    font-size: 20px;
    display: block;border-radius: 20px;
    margin: auto;
    margin-top: 10px;
    font-family: 'PixelizerBold';
    &:hover{
        background: #636363;
    }
}
.gameMenu{
    width: 300px;
    height: 300px;
    background: rgba(0, 0, 0, 0.692);
    display: block;
    position: absolute;
    z-index: 1;
    box-shadow: 0 0 70px #0b0b0b;
    border-radius: 20px;
}
#menuSettings{
    display: none;
}
input{
    width: 32px;height: 32px;background: transparent;border: 1px solid #636363;outline: none;
}
</style>
<title>ХЛЕБОНОИД: ГОВНЕНЫЙ ПУТЬ</title>
<div class="gameMenu" id="menu">
    <br>
<h1 class="text">ХЛЕБОНОИД: ГОВНЕНЫЙ ПУТЬ</h1>
<button class="menuBtn" id="startEngine">Играть</button>
<button class="menuBtn" id="SettingsEngine">Настройки</button>
<h1 class="text">pahomEngine.js_0.7.65 </h1>
<h1 class="text">HCPP STUDIO</h1>
</div>
<div class="gameMenu" id="menuSettings">
    <br>
<h1 class="stext">pahomEngine.js_0.7.65 </h1>
<br>
<h1 class="stext">breadSizeOffset.........:<input class="stext" type="comment" id="bszoffset"></h1>
<br>
<h1 class="stext">pahomSizeXYOffset:<input class="stext" type="comment" id="pszxoffset"><input class="stext" type="comment"  id="pszyoffset"></h1>
<br>
<h1 class="stext">maxWindowSizeXY....:<input class="stext" id="wszxoffset" type="comment"><input class="stext" id="wszyoffset" type="comment"></h1>
<br>
<button class="menuBtn" onclick="engine.closeSettings();">OK</button>
<br>
</div>
<div class="game_container">
    <div id="sprite_pahom" class="pahom"  style="position: fixed; transition: transform 0.1s;"><img src="assets/пахом.png"></div>
    <div id="sprite_bread" class="bread" style="position: fixed; transition: transform 0.1s;"><img src="assets/bread.png"></div>
    <div id="fps" class="framerate"></div>
    <div id="score" class="score"></div>
    <audio id="kurlik_Engine"></audio>
</div>
<script src="PahomEngine/pahomEngine.js"></script>
<script>

// Инициализация движка
const engine = new ENGINE_1_0();
engine.initGame();
let EngineStop = true;
// Цикл игры
function gameLoop() {
    if(!EngineStop){
    engine.updateGame();
    requestAnimationFrame(gameLoop);
    }
    else{
        engine.showMenu();
    }
}
let bszoffset = document.getElementById("bszoffset");
let pszxoffset = document.getElementById("pszxoffset");
let pszyoffset = document.getElementById("pszyoffset");
let wszxoffset = document.getElementById("wszxoffset");
let wszyoffset = document.getElementById("wszyoffset");
//
bszoffset.oninput = function(){
    engine.breadSize = this.value;
}
pszxoffset.oninput = function(){
    engine.breadSize = this.value;
}
pszyoffset.oninput = function(){
    engine.playerWidth = this.value;
}
wszxoffset.oninput = function(){
    engine.playerHeight = this.value;
}
wszyoffset.oninput = function(){
    engine.mapMaxCty = this.value;
}
//
startEngine.onclick = function(){
    EngineStop = false;
    gameLoop();engine.closeMenu();
}
SettingsEngine.onclick = function(){
    engine.showSettings();
    EngineStop = true;
    gameLoop();engine.closeMenu();
}
// Запуск основного цикла
    gameLoop();

// Обработчик FPS (перенесен в конец)
function updateFPS() {
    const now = performance.now();
    frameCounta++;
    
    if (now - lastTime >= 1000) {
        fps = frameCounta;
        frameCounta = 0;
        lastTime = now;
        info.innerHTML = `FPS: ${fps} [A] [D] - влево/вправо, [SPACE] - Пауза`;
        score.innerHTML = scoreCount0;
    }
    requestAnimationFrame(updateFPS);
}
engine.showMenu();
window.addEventListener("keypress",function(event){
  if(event.code == 'KeyD'){
    if(!EngineStop){
    engine.moveRight();
    }
  }
  if(event.code == 'KeyA'){
    if(!EngineStop){
    engine.moveLeft();
    }
  }
  if(event.code == 'Space'){
    EngineStop = true;engine.showMenu();
  }
});
updateFPS();
</script>
</html>