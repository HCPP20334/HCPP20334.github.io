<html>
<style>
html{
    background: #0b0b0b;
}
.pahom{
    width: 258px;
    height: 256px;
    display: block;
    transition: .2s;

}
@font-face {
    font-family: PixelizerBold;
    src: url("PahomEngine/assets/PixelizerBold.ttf");
}
.game_container{
    max-width: 100%;
    max-height: 1080px;
    width: 0px;
    height: 0px;
    overflow: hidden;
    background-image: url("PahomEngine/assets/back.jpg");
    border: 1px solid #636363;
    background-size: 200% 200%;
    transition: .4s;
}
.bread{
    width: 96px;
    height: 96px;
    display: block;
}
.framerate{
    color: white;
    font-size: 30px;
    font-family: 'PixelizerBold';
    display: inline-block;
    margin: 20px;
}
.text{
    color: white;
    font-size: 15px;
    font-family: 'PixelizerBold';
    margin: 20px;
}
.stext{
    color: white;
    font-size: 15px;
    font-family: 'PixelizerBold';
    margin: 5px;display: inline-block;
    transform: translateX(20px);
}
img{
    width: 100%;
    height: 100%;
}
.score{
    color: white;
    font-size: 60px;
    font-weight: bold;
    text-align: center;
    font-family: 'PixelizerBold';
}
.menuBtn{
    width: 90%;
    height: 30px;
    border: 1px solid #636363;
    background: #c7bfbf;
    color: rgb(0, 0, 0);
    font-size: 20px;
    display: block;border-radius: 20px;
    margin: auto;
    margin-top: 10px;
    font-family: 'PixelizerBold';
    &:hover{
        background: #636363;
    }
}
.gameMenu{
    width: 300px;
    height: 400px;
    background: rgba(0, 0, 0, 0.692);
    display: block;
    position: absolute;
    z-index: 1;
    box-shadow: 0 0 70px #0b0b0b;
    border-radius: 20px;
}
#menuSettings{
    display: none;
}
input{
    width: 32px;height: 32px;background: transparent;border: 1px solid #636363;outline: none;
}
.bar{
    width: 93%;
    border: 1px solid #c7bfbf;
    height: 20px;
    display: block;
    margin: auto;
}
#A_bar{
    width: 10px;
    background:  #c7bfbf;
    height: 20px;
    display: block;
}
.load{
    width: 330px;
    height: 330px;position: absolute;
    background: #010101;
    justify-items: center;
    z-index: 1;
}
.msgwindow{
    width: 100%;
    height: 0px;
    background: #010101;
    border: 1px solid #c7bfbf;
    overflow: hidden;
    transition: .4s;
    position: absolute;
}
#dtext{
    transform: translateY(-5px);
    text-align: center;
}
.mobileControls{
    width: 100%;
    height: 300px;border: 1px solid #c7bfbf;
}
.moveButton{
    background: #c7bfbf;
    border: 1px solid #c7bfbf;
    width: 128px;
    height: 128px;
    color: rgb(0, 0, 0);
    font-size: 20px;
    display: block;border-radius: 20px;
    margin: auto;
    margin-top: 10px;
    font-family: 'PixelizerBold';
    border-radius: 128px;
    display: inline-block;
    margin: 30px;
    &:hover{
        background: #636363;
    }
}
</style>
<title>ХЛЕБОНОИД: ГОВНЕНЫЙ ПУТЬ</title>
<meta name="viewport" content="user-scalable=no">
<link rel="icon" type="image/png" href="PahomEngine/assets/bread.png" sizes="32x32">
<div class="msgwindow" id="dwindow">
<p class="text" id="dtext"></p>
</div>
<div class="gameMenu" id="menu">
    <br>
<h1 class="text">ХЛЕБОНОИД: ГОВНЕНЫЙ ПУТЬ</h1>
<button class="menuBtn" id="startEngine">Играть</button>
<button class="menuBtn" id="SettingsEngine">Настройки</button>
<button class="menuBtn" onclick="engine.save();">Сохранить Результат</button>
<button class="menuBtn" onclick="alert(localStorage.score);">Последний результат</button>
<button class="menuBtn" onclick="engine.benchMarkCPU();">Бенчмарк CPU</button>
<h1 class="text">[pahomEngine.js_0.9012da2]</h1>
<h1 class="text">HCPP STUDIO</h1>
</div>
<div class="load" id="loadEngine">
    <br>
    <br>
<h1 class="text" id="as">Загрузка ресурсов игры..</h1>
<div class="bar">
<div id="A_bar"></div>
<p class="text" id="currentFile"></p>
</div>
</div>
<div class="gameMenu" id="menuSettings">
    <br>
<h1 class="stext">[pahomEngine.js_0.9012da2]</h1>
<br>
<h1 class="stext">breadSizeOffset.........:<input class="stext" type="comment" id="bszoffset"></h1>
<br>
<h1 class="stext">pahomSizeXYOffset:<input class="stext" type="comment" id="pszxoffset"><input class="stext" type="comment"  id="pszyoffset"></h1>
<br>
<h1 class="stext">maxWindowSizeXY....:<input class="stext" id="wszxoffset" type="comment"><input class="stext" id="wszyoffset" type="comment"></h1>
<br>
<button class="menuBtn" onclick="engine.closeSettings();">OK</button>
<br>
</div>
<div class="game_container" id="gameframe">
    <div id="sprite_pahom" class="pahom"  style="position: fixed; transition: transform 0.1s;"><img src="PahomEngine/assets/пахом.png"></div>
    <div id="sprite_bread" class="bread" style="position: fixed; transition: transform 0.1s;"><img src="PahomEngine/assets/bread.png"></div>
    <div id="fps" class="framerate"></div>
    <div id="score" class="score"></div>
    <audio id="kurlik_Engine"></audio>
</div>
<div class="mobileControls">
<button class="moveButton" id="Lbutton">L</button>
<button class="moveButton" id="Rbutton">R</button>
<button class="moveButton" id="SPACEbutton">PAUSE</button>
</div>
<script src="PahomEngine/pahomEngine.js"></script>
<script>

// Инициализация движка
const engine = new ENGINE_1_0();
engine.initGame();
let EngineStop = engine.pahomEngineState;
let  pahomEngineFiles = ["PahomEngine/assets/пахом.png","PahomEngine/assets/bread.png","PahomEngine/assets/back.jpg"];
// Цикл игры
function d(){
    engine.closeMenu();
    engine.preloadImages([
        pahomEngineFiles[0],
        pahomEngineFiles[1],
        pahomEngineFiles[2]
             ], function(){
                engine.pahomEngineState = true;
               engine.showMenu();
                engine.loadEngineFrame.style.display = "none";
              });
} d();
function gameLoop() {
    window.addEventListener("error",function(execption){
        engine.log(execption.error);
    });
    if(!EngineStop){
    engine.updateGame();
    requestAnimationFrame(gameLoop);
    document.getElementById("gameframe").style.width = "100%";
            document.getElementById("gameframe").style.height = "100%";
    }
    else{

    }
}
let bszoffset = document.getElementById("bszoffset");
let pszxoffset = document.getElementById("pszxoffset");
let pszyoffset = document.getElementById("pszyoffset");
let wszxoffset = document.getElementById("wszxoffset");
let wszyoffset = document.getElementById("wszyoffset");
//
document.getElementById("Lbutton").onclick = function(){ engine.moveLeft();}
document.getElementById("Rbutton").onclick = function(){ engine.moveRight();}
document.getElementById("SPACEbutton").onclick = function(){EngineStop = true;engine.showMenu();}
bszoffset.oninput = function(){
    engine.breadSize = this.value;
}
pszxoffset.oninput = function(){
    engine.breadSize = this.value;
}
pszyoffset.oninput = function(){
    engine.playerWidth = this.value;
}
wszxoffset.oninput = function(){
    engine.playerHeight = this.value;
}
wszyoffset.oninput = function(){
    engine.mapMaxCty = this.value;
}
//
startEngine.onclick = function(){
    EngineStop = false;

    gameLoop();engine.closeMenu();
}
SettingsEngine.onclick = function(){
    engine.showSettings();
    EngineStop = true;
    gameLoop();engine.closeMenu();
}
// Запуск основного цикла
    gameLoop();

// Обработчик FPS (перенесен в конец)
function updateFPS() {
    const now = performance.now();
    frameCounta++;
    
    if (now - lastTime >= 1000) {
        fps = frameCounta;
        frameCounta = 0;
        lastTime = now;
        info.innerHTML = `FPS: ${fps} [A] [D] - влево/вправо, [SPACE] - Пауза`;
        score.innerHTML = scoreCount0;
    }
    requestAnimationFrame(updateFPS);
}
engine.showMenu();
window.addEventListener("keypress",function(event){
  if(event.code == 'KeyD'){
    if(!EngineStop){
    engine.moveRight();
    }
  }
  if(event.code == 'KeyH'){
    alert(localStorage.score);
  }
  if(event.code == 'KeyA'){
    if(!EngineStop){
    engine.moveLeft();
    }
  }
  if(event.code == 'Space'){
    EngineStop = true;engine.showMenu();
  }
});
updateFPS();
</script>
</html>